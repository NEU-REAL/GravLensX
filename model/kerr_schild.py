import taichi as ti
@ti.func
def calculate_dgdx(x, y, z, M, a):
    b1, b2, b3, b4, b5, b6, b7, b8, b9, b10, b11, b12 = (
        1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2),
        -a ** 2 + x ** 2 + y ** 2 + z ** 2,
        (4 * a ** 2 * x * z ** 2 * (1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2))) /
        ((-a ** 2 + x ** 2 + y ** 2 + z ** 2) * ti.sqrt(
            1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)),
        (-4 * a ** 2 * x * z ** 2) /
        ((-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2 * ti.sqrt(
            1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)) +
        x * (1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)),
        (-4 * a ** 2 * x * z ** 2 * (1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2))) /
        ((-a ** 2 + x ** 2 + y ** 2 + z ** 2) * ti.sqrt(
            1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)) +
        x * (-a ** 2 + x ** 2 + y ** 2 + z ** 2) * (
                    1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)) ** 2,
        (-8 * a ** 2 * x * z ** 2) /
        ((-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2 * ti.sqrt(
            1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)) +
        2 * x * (1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)),
        a ** 2 * z ** 2 + ((-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2 *
                           (1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)) ** 2) / 4.,
        a * y + (x * ti.sqrt((-a ** 2 + x ** 2 + y ** 2 + z ** 2) *
                             (1 + ti.sqrt(
                                 1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)))) / ti.sqrt(2),
        a ** 2 + ((-a ** 2 + x ** 2 + y ** 2 + z ** 2) *
                  (1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2))) / 2.,
        -(a * x) + (y * ti.sqrt((-a ** 2 + x ** 2 + y ** 2 + z ** 2) *
                                (1 + ti.sqrt(
                                    1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)))) / ti.sqrt(2),
        ((-8 * a ** 2 * x * z ** 2) /
         ((-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2 * ti.sqrt(
             1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)) +
         2 * x * (1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2))) /
        (2. * ti.sqrt(2) * ti.sqrt((-a ** 2 + x ** 2 + y ** 2 + z ** 2) *
                                   (1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)))),
        (-a ** 2 + x ** 2 + y ** 2 + z ** 2) * (
                    1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)))
    dgdx11, dgdx12, dgdx13, dgdx14 = [-((b12**1.5*b5*M)/(ti.sqrt(2)*b7**2)) + (3*ti.sqrt(b12)*b6*M)/(2.*ti.sqrt(2)*b7),
        -((b12**1.5*b4*b8*M)/(ti.sqrt(2)*b7*b9**2)) - (b12**1.5*b5*b8*M)/(ti.sqrt(2)*b7**2*b9) +
         (3*ti.sqrt(b12)*b6*b8*M)/(2.*ti.sqrt(2)*b7*b9) +
         (b12**1.5*M*(ti.sqrt(b12)/ti.sqrt(2) + b11*x))/(ti.sqrt(2)*b7*b9),
        -((b10*b12**1.5*b4*M)/(ti.sqrt(2)*b7*b9**2)) - (b10*b12**1.5*b5*M)/(ti.sqrt(2)*b7**2*b9) +
         (3*b10*ti.sqrt(b12)*b6*M)/(2.*ti.sqrt(2)*b7*b9) + (b12**1.5*M*(-a + b11*y))/(ti.sqrt(2)*b7*b9),
        -((b12*b5*M*z)/b7**2) + (2*b1*M*x*z)/b7 -
         (8*a**2*M*x*z**3)/(b2**2*b7*ti.sqrt(1 + (4*a**2*z**2)/b2**2))]
    dgdx22, dgdx23, dgdx24 = [-((ti.sqrt(2)*b12**1.5*b4*b8**2*M)/(b7*b9**3)) - (b12**1.5*b5*b8**2*M)/(ti.sqrt(2)*b7**2*b9**2) +
         (3*ti.sqrt(b12)*b6*b8**2*M)/(2.*ti.sqrt(2)*b7*b9**2) +
         (ti.sqrt(2)*b12**1.5*b8*M*(ti.sqrt(b12)/ti.sqrt(2) + b11*x))/(b7*b9**2),
        -((ti.sqrt(2)*b10*b12**1.5*b4*b8*M)/(b7*b9**3)) - (b10*b12**1.5*b5*b8*M)/(ti.sqrt(2)*b7**2*b9**2) +
         (3*b10*ti.sqrt(b12)*b6*b8*M)/(2.*ti.sqrt(2)*b7*b9**2) +
         (b10*b12**1.5*M*(ti.sqrt(b12)/ti.sqrt(2) + b11*x))/(ti.sqrt(2)*b7*b9**2) +
         (b12**1.5*b8*M*(-a + b11*y))/(ti.sqrt(2)*b7*b9**2),
        -((b12*b4*b8*M*z)/(b7*b9**2)) - (b12*b5*b8*M*z)/(b7**2*b9) + (2*b1*b8*M*x*z)/(b7*b9) +
         (b12*M*(ti.sqrt(b1*b2)/ti.sqrt(2) + b11*x)*z)/(b7*b9) -
         (8*a**2*b8*M*x*z**3)/(b2**2*b7*b9*ti.sqrt(1 + (4*a**2*z**2)/b2**2))]
    dgdx33, dgdx34 = [-((ti.sqrt(2)*b10**2*b12**1.5*b4*M)/(b7*b9**3)) - (b10**2*b12**1.5*b5*M)/(ti.sqrt(2)*b7**2*b9**2) +
         (3*b10**2*ti.sqrt(b12)*b6*M)/(2.*ti.sqrt(2)*b7*b9**2) +
         (ti.sqrt(2)*b10*b12**1.5*M*(-a + b11*y))/(b7*b9**2),
        -((b10*b12*b4*M*z)/(b7*b9**2)) - (b10*b12*b5*M*z)/(b7**2*b9) + (2*b1*b10*M*x*z)/(b7*b9) +
         (b12*M*(-a + b11*y)*z)/(b7*b9) -
         (8*a**2*b10*M*x*z**3)/(b2**2*b7*b9*ti.sqrt(1 + (4*a**2*z**2)/b2**2))]
    dgdx44 = -((ti.sqrt(2)*b12**1.5*b5*M*z**2)/(b1*b2*b7**2)) + (3*ti.sqrt(b12)*b6*M*z**2)/(ti.sqrt(2)*b1*b2*b7) - (2*ti.sqrt(2)*b12**1.5*M*x*z**2)/(b1*b2**2*b7) + (8*ti.sqrt(2)*a**2*b12**1.5*M*x*z**4)/(b1**2*b2**4*b7*ti.sqrt(1 + (4*a**2*z**2)/b2**2))


    dgdx = ti.Matrix([[dgdx11, dgdx12, dgdx13, dgdx14],
                      [dgdx12, dgdx22, dgdx23, dgdx24],
                      [dgdx13, dgdx23, dgdx33, dgdx34],
                      [dgdx14, dgdx24, dgdx34, dgdx44]])
    return dgdx

@ti.func
def calculate_dgdx_complex(x, y, z, M, a):
    dgdx11, dgdx12, dgdx13, dgdx14, dgdx21, dgdx22, dgdx23, dgdx24, dgdx31, dgdx32, dgdx33, dgdx34, dgdx41, dgdx42, dgdx43, dgdx44 = (-ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-4*a**2*x*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))/(2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) + 3*ti.sqrt(2)*M*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(-8*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                        -ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*x*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) + ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(ti.sqrt(2)*x*(-8*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))) + ti.sqrt(2)*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + 3*ti.sqrt(2)*M*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-8*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                        ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a + ti.sqrt(2)*y*(-8*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*x*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + 3*ti.sqrt(2)*M*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-8*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                        -8*M*a**2*x*z**3/((a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*M*x*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4) - M*z*(-4*a**2*x*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2,
                                                                                                                                       -ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*x*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) + ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(ti.sqrt(2)*x*(-8*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))) + ti.sqrt(2)*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + 3*ti.sqrt(2)*M*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-8*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                        -ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)**2*(-4*a**2*x*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) + ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(2)*x*(-8*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))) + ti.sqrt(2)*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)**2*(-4*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**3*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + 3*ti.sqrt(2)*M*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)**2*(-8*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                        ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a + ti.sqrt(2)*y*(-8*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))))*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*x*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) + ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(2)*x*(-8*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))) + ti.sqrt(2)*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**3*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + 3*ti.sqrt(2)*M*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-8*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                        -8*M*a**2*x*z**3*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*M*x*z*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - M*z*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*x*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) + M*z*(ti.sqrt(2)*x*(-8*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))) + ti.sqrt(2)*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - M*z*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                       ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a + ti.sqrt(2)*y*(-8*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*x*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + 3*ti.sqrt(2)*M*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-8*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                        ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a + ti.sqrt(2)*y*(-8*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))))*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*x*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) + ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(2)*x*(-8*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))) + ti.sqrt(2)*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**3*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + 3*ti.sqrt(2)*M*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-8*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                        ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a + ti.sqrt(2)*y*(-8*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))))*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)**2*(-4*a**2*x*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)**2*(-4*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**3*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + 3*ti.sqrt(2)*M*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)**2*(-8*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                        -8*M*a**2*x*z**3*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*M*x*z*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + M*z*(-a + ti.sqrt(2)*y*(-8*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - M*z*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*x*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) - M*z*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                       -8*M*a**2*x*z**3/((a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*M*x*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4) - M*z*(-4*a**2*x*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2,
                                                                                                                                        -8*M*a**2*x*z**3*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*M*x*z*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - M*z*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*x*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) + M*z*(ti.sqrt(2)*x*(-8*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))) + ti.sqrt(2)*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - M*z*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                        -8*M*a**2*x*z**3*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*M*x*z*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + M*z*(-a + ti.sqrt(2)*y*(-8*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - M*z*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*x*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) - M*z*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                        8*ti.sqrt(2)*M*a**2*x*z**4*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)/((a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**4) - 2*ti.sqrt(2)*M*x*z**2*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)/((a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)**2) - ti.sqrt(2)*M*z**2*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-4*a**2*x*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))/((a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)) + 3*ti.sqrt(2)*M*z**2*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(-8*a**2*x*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*x*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)))
    dgdx = ti.Matrix([[dgdx11, dgdx12, dgdx13, dgdx14],
                      [dgdx21, dgdx22, dgdx23, dgdx24],
                      [dgdx31, dgdx32, dgdx33, dgdx34],
                      [dgdx41, dgdx42, dgdx43, dgdx44]])
    return dgdx

# @ti.func
# def calculate_dgdx(x, y, z, M, a):
#     radius2 = x ** 2 + y ** 2 + z ** 2
#     r = (1 / 2 * (radius2 - a ** 2) * (1 + (1 + 4 * a ** 2 * z ** 2 / (radius2 - a ** 2) ** 2) ** (1 / 2))) ** (1 / 2)
#     l1 = (r * x + a * y) / (r ** 2 + a ** 2)
#     l2 = (r * y - a * x) / (r ** 2 + a ** 2)
#     l3 = z / r
#     H = 2 * M * r**3/(r**4 + a**2 * z**2)
#     drdradius2 = ti.sqrt(2)*(-4*a**2*z**2/((-a**2 + radius2)**2*ti.sqrt(4*a**2*z**2/(-a**2 + radius2)**2 + 1)) + ti.sqrt(4*a**2*z**2/(-a**2 + radius2)**2 + 1) + 1)/(4*ti.sqrt((-a**2 + radius2)*(ti.sqrt(4*a**2*z**2/(-a**2 + radius2)**2 + 1) + 1)))
#     dHdr = (-8 * M * r ** 6) / (r ** 4 + a ** 2 * z ** 2) ** 2 + (6 * M * r ** 2) / (r ** 4 + a ** 2 * z ** 2)
#     dHdx = dHdr * drdradius2 * 2 * x
#     dl1dx = r / (a ** 2 + r ** 2) + 2 * r * (a * y + r * x) / (a ** 2 + r ** 2) ** 2 * drdradius2 * 2 * x
#     dl2dx = r / (a ** 2 + r ** 2) + (-2*r*(-a*x + r*y)/(a**2 + r**2)**2 + y/(a**2 + r**2)) * drdradius2 * 2 * x
#     dl3dx = (-z/r**2) * (drdradius2 * 2 * x)
#     dgdl1 = ti.Matrix([[0,H,0,0],[H,2*H*l1,H*l2,H*l3],[0,l2*H,0,0],[0,l3*H,0,0]])
#     dgdl2 = ti.Matrix([[0,0,H,0],[0,0,H*l1,0],[H,H*l1,2*H*l2,H*l3],[0,0,H*l3,0]])
#     dgdl3 = ti.Matrix([[0,0,0,H],[0,0,0,H*l1],[0,0,0,H*l2],[H,H*l1,H*l2,2*H*l3]])
#     dgdH = ti.Matrix([[1,l1,l2,l3],[l1,l1**2,l1*l2,l1*l3],[l2,l1*l2,l2**2,l2*l3],[l3,l1*l3,l2*l3,l3**2]])
#     dgdx = dgdl1 * dl1dx + dgdl2 * dl2dx + dgdl3 * dl3dx + dgdH * dHdx
#     return dgdx

@ti.func
def calculate_dgdy(x, y, z, M, a):
    b1, b2, b3, b4, b5, b6, b7, b8, b9, b10, b11, b12 = (
        1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2),
        -a ** 2 + x ** 2 + y ** 2 + z ** 2,
        (-4 * a ** 2 * y * z ** 2) / ((-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2 * ti.sqrt(
            1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)) +
        y * (1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)),
        (-4 * a ** 2 * y * z ** 2 * (1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2))) /
        ((-a ** 2 + x ** 2 + y ** 2 + z ** 2) * ti.sqrt(
            1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)) +
        y * (-a ** 2 + x ** 2 + y ** 2 + z ** 2) * (
                    1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)) ** 2,
        (-8 * a ** 2 * y * z ** 2) / ((-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2 * ti.sqrt(
            1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)) +
        2 * y * (1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)),
        (x * ((-8 * a ** 2 * y * z ** 2) / ((-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2 * ti.sqrt(
            1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)) +
              2 * y * (1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)))) /
        (2. * ti.sqrt(2) * ti.sqrt((-a ** 2 + x ** 2 + y ** 2 + z ** 2) * (
                    1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)))),
        a ** 2 * z ** 2 + ((-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2 * (
                    1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)) ** 2) / 4.,
        a * y + (x * ti.sqrt((-a ** 2 + x ** 2 + y ** 2 + z ** 2) * (
                    1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)))) / ti.sqrt(2),
        a ** 2 + ((-a ** 2 + x ** 2 + y ** 2 + z ** 2) * (
                    1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2))) / 2.,
        -(a * x) + (y * ti.sqrt((-a ** 2 + x ** 2 + y ** 2 + z ** 2) * (
                    1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)))) / ti.sqrt(2),
        M * (ti.sqrt((-a ** 2 + x ** 2 + y ** 2 + z ** 2) * (
                    1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2))) / ti.sqrt(2) +
             (y * ((-8 * a ** 2 * y * z ** 2) / ((-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2 * ti.sqrt(
                 1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)) +
                   2 * y * (1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)))) /
             (2. * ti.sqrt(2) * ti.sqrt((-a ** 2 + x ** 2 + y ** 2 + z ** 2) * (
                         1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2))))),
        (-a ** 2 + x ** 2 + y ** 2 + z ** 2) * (
                    1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)))
    dgdy11, dgdy12, dgdy13, dgdy14 = [-((b12**1.5*b4*M)/(ti.sqrt(2)*b7**2)) + (3*ti.sqrt(b12)*b5*M)/(2.*ti.sqrt(2)*b7),-((b12**1.5*b3*b8*M)/(ti.sqrt(2)*b7*b9**2)) + (b12**1.5*(a + b6)*M)/(ti.sqrt(2)*b7*b9) - (b12**1.5*b4*b8*M)/(ti.sqrt(2)*b7**2*b9) +
        (3*ti.sqrt(b12)*b5*b8*M)/(2.*ti.sqrt(2)*b7*b9),(b11*b12**1.5)/(ti.sqrt(2)*b7*b9) - (b10*b12**1.5*b3*M)/(ti.sqrt(2)*b7*b9**2) - (b10*b12**1.5*b4*M)/(ti.sqrt(2)*b7**2*b9) + (3*b10*ti.sqrt(b12)*b5*M)/(2.*ti.sqrt(2)*b7*b9),
        -((b12*b4*M*z)/b7**2) + (2*b1*M*y*z)/b7 - (8*a**2*M*y*z**3)/(b2**2*b7*ti.sqrt(1 + (4*a**2*z**2)/b2**2))]
    dgdy22, dgdy23, dgdy24 = [-((ti.sqrt(2)*b12**1.5*b3*b8**2*M)/(b7*b9**3)) + (ti.sqrt(2)*b12**1.5*(a + b6)*b8*M)/(b7*b9**2) - (b12**1.5*b4*b8**2*M)/(ti.sqrt(2)*b7**2*b9**2) + (3*ti.sqrt(b12)*b5*b8**2*M)/(2.*ti.sqrt(2)*b7*b9**2),
        (b11*b12**1.5*b8)/(ti.sqrt(2)*b7*b9**2) - (ti.sqrt(2)*b10*b12**1.5*b3*b8*M)/(b7*b9**3) + (b10*b12**1.5*(a + b6)*M)/(ti.sqrt(2)*b7*b9**2) - (b10*b12**1.5*b4*b8*M)/(ti.sqrt(2)*b7**2*b9**2) + (3*b10*ti.sqrt(b12)*b5*b8*M)/(2.*ti.sqrt(2)*b7*b9**2),
        -((b12*b3*b8*M*z)/(b7*b9**2)) + (b12*(a + b6)*M*z)/(b7*b9) - (b12*b4*b8*M*z)/(b7**2*b9) + (2*b1*b8*M*y*z)/(b7*b9) - (8*a**2*b8*M*y*z**3)/(b2**2*b7*b9*ti.sqrt(1 + (4*a**2*z**2)/b2**2))]
    dgdy33, dgdy34 = [(ti.sqrt(2)*b10*b11*b12**1.5)/(b7*b9**2) - (ti.sqrt(2)*b10**2*b12**1.5*b3*M)/(b7*b9**3) - (b10**2*b12**1.5*b4*M)/(ti.sqrt(2)*b7**2*b9**2) + (3*b10**2*ti.sqrt(b12)*b5*M)/(2.*ti.sqrt(2)*b7*b9**2),
        (b11*b12*z)/(b7*b9) - (b10*b12*b3*M*z)/(b7*b9**2) - (b10*b12*b4*M*z)/(b7**2*b9) + (2*b1*b10*M*y*z)/(b7*b9) - (8*a**2*b10*M*y*z**3)/(b2**2*b7*b9*ti.sqrt(1 + (4*a**2*z**2)/b2**2))]
    dgdy44 = -((ti.sqrt(2)*b12**1.5*b4*M*z**2)/(b1*b2*b7**2)) + (3*ti.sqrt(b12)*b5*M*z**2)/(ti.sqrt(2)*b1*b2*b7) - (2*ti.sqrt(2)*b12**1.5*M*y*z**2)/(b1*b2**2*b7) + (8*ti.sqrt(2)*a**2*b12**1.5*M*y*z**4)/(b1**2*b2**4*b7*ti.sqrt(1 + (4*a**2*z**2)/b2**2))
    dgdy = ti.Matrix([[dgdy11, dgdy12, dgdy13, dgdy14],
                      [dgdy12, dgdy22, dgdy23, dgdy24],
                      [dgdy13, dgdy23, dgdy33, dgdy34],
                      [dgdy14, dgdy24, dgdy34, dgdy44]])
    return dgdy

@ti.func
def calculate_dgdy_complex(x, y, z, M, a):
    dgdy11, dgdy12, dgdy13, dgdy14, dgdy21, dgdy22, dgdy23, dgdy24, dgdy31, dgdy32, dgdy33, dgdy34, dgdy41, dgdy42, dgdy43, dgdy44 = (-ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-4*a**2*y*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))/(2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) + 3*ti.sqrt(2)*M*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(-8*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                      ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(a + ti.sqrt(2)*x*(-8*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*y*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + 3*ti.sqrt(2)*M*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-8*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                      -ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*y*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) + ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(ti.sqrt(2)*y*(-8*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))) + ti.sqrt(2)*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + 3*ti.sqrt(2)*M*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-8*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                      -8*M*a**2*y*z**3/((a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*M*y*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4) - M*z*(-4*a**2*y*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2,
                                                                                                                                      ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(a + ti.sqrt(2)*x*(-8*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*y*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + 3*ti.sqrt(2)*M*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-8*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                      ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(a + ti.sqrt(2)*x*(-8*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))))*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)**2*(-4*a**2*y*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)**2*(-4*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**3*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + 3*ti.sqrt(2)*M*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)**2*(-8*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                      ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(a + ti.sqrt(2)*x*(-8*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))))*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*y*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) + ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(2)*y*(-8*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))) + ti.sqrt(2)*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**3*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + 3*ti.sqrt(2)*M*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-8*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                      -8*M*a**2*y*z**3*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*M*y*z*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + M*z*(a + ti.sqrt(2)*x*(-8*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - M*z*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*y*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) - M*z*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                      -ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*y*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) + ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(ti.sqrt(2)*y*(-8*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))) + ti.sqrt(2)*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + 3*ti.sqrt(2)*M*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-8*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                      ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(a + ti.sqrt(2)*x*(-8*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))))*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*y*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) + ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(2)*y*(-8*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))) + ti.sqrt(2)*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**3*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + 3*ti.sqrt(2)*M*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-8*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                      -ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)**2*(-4*a**2*y*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) + ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(2)*y*(-8*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))) + ti.sqrt(2)*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)**2*(-4*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**3*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + 3*ti.sqrt(2)*M*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)**2*(-8*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                      -8*M*a**2*y*z**3*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*M*y*z*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - M*z*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*y*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) + M*z*(ti.sqrt(2)*y*(-8*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))) + ti.sqrt(2)*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - M*z*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                      -8*M*a**2*y*z**3/((a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*M*y*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4) - M*z*(-4*a**2*y*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2,
                                                                                                                                      -8*M*a**2*y*z**3*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*M*y*z*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + M*z*(a + ti.sqrt(2)*x*(-8*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - M*z*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*y*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) - M*z*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                      -8*M*a**2*y*z**3*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*M*y*z*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - M*z*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*y*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) + M*z*(ti.sqrt(2)*y*(-8*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))) + ti.sqrt(2)*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - M*z*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-4*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                      8*ti.sqrt(2)*M*a**2*y*z**4*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)/((a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**4) - 2*ti.sqrt(2)*M*y*z**2*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)/((a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)**2) - ti.sqrt(2)*M*z**2*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-4*a**2*y*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)) + y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2))/((a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)) + 3*ti.sqrt(2)*M*z**2*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(-8*a**2*y*z**2/(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(-a**2 + x**2 + y**2 + z**2)**2) + 2*y*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1))/(2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)))
    dgdy = ti.Matrix([[dgdy11, dgdy12, dgdy13, dgdy14],
                      [dgdy21, dgdy22, dgdy23, dgdy24],
                      [dgdy31, dgdy32, dgdy33, dgdy34],
                      [dgdy41, dgdy42, dgdy43, dgdy44]])
    return dgdy

@ti.func
def calculate_dgdz(x, y, z, M, a):
    b1, b2, b3, b4, b5, b6, b7, b8, b9, b10, b11, b12 = (
        1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2),
        -a ** 2 + x ** 2 + y ** 2 + z ** 2,
        (-16 * a ** 2 * z ** 3) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 3 + (8 * a ** 2 * z) / (
                    -a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2,
        ((-a ** 2 + x ** 2 + y ** 2 + z ** 2) * ((-16 * a ** 2 * z ** 3) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 3 +
                                                 (8 * a ** 2 * z) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)) /
        (2. * ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)) +
        2 * z * (1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)),
        2 * a ** 2 * z + ((-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2 *
                          ((-16 * a ** 2 * z ** 3) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 3 +
                           (8 * a ** 2 * z) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2) *
                          (1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2))) /
        (4. * ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)) +
        z * (-a ** 2 + x ** 2 + y ** 2 + z ** 2) * (
                    1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)) ** 2,
        ((-a ** 2 + x ** 2 + y ** 2 + z ** 2) * ((-16 * a ** 2 * z ** 3) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 3 +
                                                 (8 * a ** 2 * z) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)) /
        (4. * ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)) +
        z * (1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)),
        a ** 2 * z ** 2 + ((-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2 *
                           (1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)) ** 2) / 4.,
        a * y + (x * ti.sqrt((-a ** 2 + x ** 2 + y ** 2 + z ** 2) *
                             (1 + ti.sqrt(
                                 1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)))) / ti.sqrt(2),
        a ** 2 + ((-a ** 2 + x ** 2 + y ** 2 + z ** 2) *
                  (1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2))) / 2.,
        -(a * x) + (y * ti.sqrt((-a ** 2 + x ** 2 + y ** 2 + z ** 2) *
                                (1 + ti.sqrt(
                                    1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)))) / ti.sqrt(2),
        (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2,
        (-a ** 2 + x ** 2 + y ** 2 + z ** 2) * (
                    1 + ti.sqrt(1 + (4 * a ** 2 * z ** 2) / (-a ** 2 + x ** 2 + y ** 2 + z ** 2) ** 2)))
    dgdz11, dgdz12, dgdz13, dgdz14 = [-((b12**1.5*b5*M)/(ti.sqrt(2)*b7**2)) + (3*ti.sqrt(b12)*b4*M)/(2.*ti.sqrt(2)*b7),-((b12**1.5*b6*b8*M)/(ti.sqrt(2)*b7*b9**2)) - (b12**1.5*b5*b8*M)/(ti.sqrt(2)*b7**2*b9) + (3*ti.sqrt(b12)*b4*b8*M)/(2.*ti.sqrt(2)*b7*b9) + (b12*b4*M*x)/(4.*b7*b9),
        -((b10*b12**1.5*b6*M)/(ti.sqrt(2)*b7*b9**2)) - (b10*b12**1.5*b5*M)/(ti.sqrt(2)*b7**2*b9) + (3*b10*ti.sqrt(b12)*b4*M)/(2.*ti.sqrt(2)*b7*b9) + (b12*b4*M*y)/(4.*b7*b9),(b12*M)/b7 - (b12*b5*M*z)/b7**2 + (b2*b3*M*z)/(2.*ti.sqrt(1 + b11)*b7) + (2*b1*M*z**2)/b7]
    dgdz22, dgdz23, dgdz24 = [-((ti.sqrt(2)*b12**1.5*b6*b8**2*M)/(b7*b9**3)) - (b12**1.5*b5*b8**2*M)/(ti.sqrt(2)*b7**2*b9**2) + (3*ti.sqrt(b12)*b4*b8**2*M)/(2.*ti.sqrt(2)*b7*b9**2) + (b12*b4*b8*M*x)/(2.*b7*b9**2),
        -((ti.sqrt(2)*b10*b12**1.5*b6*b8*M)/(b7*b9**3)) - (b10*b12**1.5*b5*b8*M)/(ti.sqrt(2)*b7**2*b9**2) + (3*b10*ti.sqrt(b12)*b4*b8*M)/(2.*ti.sqrt(2)*b7*b9**2) + (b10*b12*b4*M*x)/(4.*b7*b9**2) + (b12*b4*b8*M*y)/(4.*b7*b9**2),
        (b12*b8*M)/(b7*b9) - (b12*b6*b8*M*z)/(b7*b9**2) - (b12*b5*b8*M*z)/(b7**2*b9) + (b2*b3*b8*M*z)/(2.*ti.sqrt(1 + b11)*b7*b9) + (b12*b4*M*x*z)/(2.*ti.sqrt(2)*ti.sqrt(b1*b2)*b7*b9) + (2*b1*b8*M*z**2)/(b7*b9)]
    dgdz33, dgdz34 = [-((ti.sqrt(2)*b10**2*b12**1.5*b6*M)/(b7*b9**3)) - (b10**2*b12**1.5*b5*M)/(ti.sqrt(2)*b7**2*b9**2) + (3*b10**2*ti.sqrt(b12)*b4*M)/(2.*ti.sqrt(2)*b7*b9**2) + (b10*b12*b4*M*y)/(2.*b7*b9**2),
        (b10*b12*M)/(b7*b9) - (b10*b12*b6*M*z)/(b7*b9**2) - (b10*b12*b5*M*z)/(b7**2*b9) + (b10*b2*b3*M*z)/(2.*ti.sqrt(1 + b11)*b7*b9) + (b12*b4*M*y*z)/(2.*ti.sqrt(2)*ti.sqrt(b1*b2)*b7*b9) + (2*b1*b10*M*z**2)/(b7*b9)]
    dgdz44 = (2*ti.sqrt(2)*b12**1.5*M*z)/(b1*b2*b7) - (ti.sqrt(2)*b12**1.5*b5*M*z**2)/(b1*b2*b7**2) - (b12**1.5*b3*M*z**2)/(ti.sqrt(2)*b1**2*ti.sqrt(1 + b11)*b2*b7) + (3*ti.sqrt(b12)*b4*M*z**2)/(ti.sqrt(2)*b1*b2*b7) - (2*ti.sqrt(2)*b12**1.5*M*z**3)/(b1*b2**2*b7)
    dgdz = ti.Matrix([[dgdz11, dgdz12, dgdz13, dgdz14],
                      [dgdz12, dgdz22, dgdz23, dgdz24],
                      [dgdz13, dgdz23, dgdz33, dgdz34],
                      [dgdz14, dgdz24, dgdz34, dgdz44]])
    return dgdz

@ti.func
def calculate_dgdz_complex(x, y, z, M, a):
    dgdz11, dgdz12, dgdz13, dgdz14, dgdz21, dgdz22, dgdz23, dgdz24, dgdz31, dgdz32, dgdz33, dgdz34, dgdz41, dgdz42, dgdz43, dgdz44 = (-ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(2*a**2*z + z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)**2/(4*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))/(2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) + 3*ti.sqrt(2)*M*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(2*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))/(4*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                      M*x*(2*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(2*a**2*z + z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)**2/(4*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(4*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + 3*ti.sqrt(2)*M*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(2*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                      M*y*(2*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(2*a**2*z + z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)**2/(4*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(4*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + 3*ti.sqrt(2)*M*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(2*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                      2*M*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4) + M*z*(-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)) - M*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(2*a**2*z + z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)**2/(4*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))*(-a**2 + x**2 + y**2 + z**2)/(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2 + M*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4),
                                                                                                                                      M*x*(2*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(2*a**2*z + z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)**2/(4*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(4*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + 3*ti.sqrt(2)*M*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(2*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                      M*x*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(2*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)**2*(2*a**2*z + z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)**2/(4*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)**2*(z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(4*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**3*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + 3*ti.sqrt(2)*M*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)**2*(2*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                      M*x*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(2*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + M*y*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(2*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(2*a**2*z + z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)**2/(4*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(4*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**3*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + 3*ti.sqrt(2)*M*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(2*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                      ti.sqrt(2)*M*x*z*(2*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + 2*M*z**2*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + M*z*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)) - M*z*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(2*a**2*z + z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)**2/(4*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) - M*z*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(4*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + M*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                      M*y*(2*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(2*a**2*z + z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)**2/(4*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(4*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + 3*ti.sqrt(2)*M*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(2*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                      M*x*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(2*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + M*y*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(2*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(2*a**2*z + z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)**2/(4*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(4*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**3*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + 3*ti.sqrt(2)*M*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(2*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                      M*y*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(2*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)**2*(2*a**2*z + z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)**2/(4*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) - ti.sqrt(2)*M*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)**2*(z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(4*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**3*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + 3*ti.sqrt(2)*M*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)**2*(2*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))/(4*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                      ti.sqrt(2)*M*y*z*(2*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + 2*M*z**2*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + M*z*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)) - M*z*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(2*a**2*z + z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)**2/(4*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) - M*z*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(4*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + M*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                      2*M*z**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4) + M*z*(-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)) - M*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(2*a**2*z + z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)**2/(4*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))*(-a**2 + x**2 + y**2 + z**2)/(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2 + M*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4),
                                                                                                                                      ti.sqrt(2)*M*x*z*(2*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + 2*M*z**2*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + M*z*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)) - M*z*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(2*a**2*z + z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)**2/(4*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) - M*z*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(4*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + M*(a*y + ti.sqrt(2)*x*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                      ti.sqrt(2)*M*y*z*(2*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/(4*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + 2*M*z**2*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + M*z*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*(a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)) - M*z*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(2*a**2*z + z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)**2/(4*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2) - M*z*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(4*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)**2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)) + M*(-a*x + ti.sqrt(2)*y*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))/2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/((a**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)/2)*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)),
                                                                                                                                      -2*ti.sqrt(2)*M*z**3*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)/((a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)**2) - ti.sqrt(2)*M*z**2*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)/(2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)) - ti.sqrt(2)*M*z**2*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)*(2*a**2*z + z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)**2/(4*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))/((a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)**2*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)) + 3*ti.sqrt(2)*M*z**2*ti.sqrt((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))*(2*z*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1) + (-16*a**2*z**3/(-a**2 + x**2 + y**2 + z**2)**3 + 8*a**2*z/(-a**2 + x**2 + y**2 + z**2)**2)*(-a**2 + x**2 + y**2 + z**2)/(2*ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1)))/(2*(a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)) + 2*ti.sqrt(2)*M*z*((ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2))**(3/2)/((a**2*z**2 + (ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)**2*(-a**2 + x**2 + y**2 + z**2)**2/4)*(ti.sqrt(4*a**2*z**2/(-a**2 + x**2 + y**2 + z**2)**2 + 1) + 1)*(-a**2 + x**2 + y**2 + z**2)))

    dgdz = ti.Matrix([[dgdz11, dgdz12, dgdz13, dgdz14],
                      [dgdz21, dgdz22, dgdz23, dgdz24],
                      [dgdz31, dgdz32, dgdz33, dgdz34],
                      [dgdz41, dgdz42, dgdz43, dgdz44]])
    return dgdz

@ti.func
def calculate_nonrotate_dgdz(x, y, z, M):
    b1 = x** 2 + y ** 2 + z ** 2

    dgdz = ti.Matrix([[(-2 * M * z) / b1 ** 1.5, (-4 * M * x * z) / b1 ** 2, (-4 * M * y * z) / b1 ** 2,
      (2 * M) / b1 - (4 * M * z ** 2) / b1 ** 2],
     [(-4 * M * x * z) / b1 ** 2, (-6 * M * x ** 2 * z) / b1 ** 2.5, (-6 * M * x * y * z) / b1 ** 2.5,
      (2 * M * x) / b1 ** 1.5 - (6 * M * x * z ** 2) / b1 ** 2.5],
     [(-4 * M * y * z) / b1 ** 2, (-6 * M * x * y * z) / b1 ** 2.5, (-6 * M * y ** 2 * z) / b1 ** 2.5,
      (2 * M * y) / b1 ** 1.5 - (6 * M * y * z ** 2) / b1 ** 2.5],
     [(2 * M) / b1 - (4 * M * z ** 2) / b1 ** 2, (2 * M * x) / b1 ** 1.5 - (6 * M * x * z ** 2) / b1 ** 2.5,
      (2 * M * y) / b1 ** 1.5 - (6 * M * y * z ** 2) / b1 ** 2.5,
      (4 * M * z) / b1 ** 1.5 - (6 * M * z ** 3) / b1 ** 2.5]])
    return dgdz

@ti.func
def calculate_nonrotate_dgdx(x, y, z, M):
    b1 = x** 2 + y ** 2 + z ** 2

    dgdx = ti.Matrix([[(-2 * M * x) / b1 ** 1.5, (2 * M) / b1 - (4 * M * x ** 2) / b1 ** 2, (-4 * M * x * y) / b1 ** 2,
                       (-4 * M * x * z) / b1 ** 2],
                    [(2 * M) / b1 - (4 * M * x ** 2) / b1 ** 2,
                      (4 * M * x) / b1 ** 1.5 - (6 * M * x ** 3) / b1 ** 2.5,
                      (2 * M * y) / b1 ** 1.5 - (6 * M * x ** 2 * y) / b1 ** 2.5,
                      (2 * M * z) / b1 ** 1.5 - (6 * M * x ** 2 * z) / b1 ** 2.5],
                    [(-4 * M * x * y) / b1 ** 2, (2 * M * y) / b1 ** 1.5 - (6 * M * x ** 2 * y) / b1 ** 2.5,
                     (-6 * M * x * y ** 2) / b1 ** 2.5, (-6 * M * x * y * z) / b1 ** 2.5],
                    [(-4 * M * x * z) / b1 ** 2, (2 * M * z) / b1 ** 1.5 - (6 * M * x ** 2 * z) / b1 ** 2.5,
                     (-6 * M * x * y * z) / b1 ** 2.5, (-6 * M * x * z ** 2) / b1 ** 2.5]])
    return dgdx

@ti.func
def calculate_nonrotate_dgdy(x, y, z, M):
    b1 = x ** 2 + y ** 2 + z ** 2
    dgdy = ti.Matrix([[(-2 * M * y) / b1 ** 1.5, (-4 * M * x * y) / b1 ** 2, (2 * M) / b1 - (4 * M * y ** 2) / b1 ** 2,
                       (-4 * M * y * z) / b1 ** 2], [(-4 * M * x * y) / b1 ** 2, (-6 * M * x ** 2 * y) / b1 ** 2.5,
                                                     (2 * M * x) / b1 ** 1.5 - (6 * M * x * y ** 2) / b1 ** 2.5,
                                                     (-6 * M * x * y * z) / b1 ** 2.5],
                      [(2 * M) / b1 - (4 * M * y ** 2) / b1 ** 2,
                       (2 * M * x) / b1 ** 1.5 - (6 * M * x * y ** 2) / b1 ** 2.5,
                       (4 * M * y) / b1 ** 1.5 - (6 * M * y ** 3) / b1 ** 2.5,
                       (2 * M * z) / b1 ** 1.5 - (6 * M * y ** 2 * z) / b1 ** 2.5],
                      [(-4 * M * y * z) / b1 ** 2, (-6 * M * x * y * z) / b1 ** 2.5,
                       (2 * M * z) / b1 ** 1.5 - (6 * M * y ** 2 * z) / b1 ** 2.5, (-6 * M * y * z ** 2) / b1 ** 2.5]])
    return dgdy

@ti.func
def calculate_g(x, y, z, M, a):
    radius2 = x ** 2 + y ** 2 + z ** 2
    r = (1 / 2 * (radius2 - a ** 2) * (1 + (1 + 4 * a ** 2 * z ** 2 / (radius2 - a ** 2) ** 2) ** (1 / 2))) ** (1 / 2)
    H = 2 * M * r ** 3 / (r ** 4 + a ** 2 * z ** 2)
    l = ti.Vector([1, (r * x + a * y) / (r ** 2 + a ** 2), (r * y - a * x) / (r ** 2 + a ** 2), z / r])
    g = H * ti.Matrix([[l[0] * l[0], l[0] * l[1], l[0] * l[2], l[0] * l[3]],
                        [l[1] * l[0], l[1] * l[1], l[1] * l[2], l[1] * l[3]],
                        [l[2] * l[0], l[2] * l[1], l[2] * l[2], l[2] * l[3]],
                        [l[3] * l[0], l[3] * l[1], l[3] * l[2], l[3] * l[3]]])
    return g

# @ti.func
# def calculate_g(x, y, z, M, a):
#     radius2 = x ** 2 + y ** 2 + z ** 2
#     r = (1 / 2 * (radius2 - a ** 2) * (1 + (1 + 4 * a ** 2 * z ** 2 / (radius2 - a ** 2) ** 2) ** (1 / 2))) ** (1 / 2)
#     H = 2 * M * r ** 3 / (r ** 4 + a ** 2 * z ** 2)
#     l = ti.Vector([1, (r * x + a * y) / (r ** 2 + a ** 2), (r * y - a * x) / (r ** 2 + a ** 2), z / r])
#     g = H * ti.Matrix([[l[0] * l[0], l[0] * l[1], l[0] * l[2], l[0] * l[3]],
#                         [l[1] * l[0], l[1] * l[1], l[1] * l[2], l[1] * l[3]],
#                         [l[2] * l[0], l[2] * l[1], l[2] * l[2], l[2] * l[3]],
#                         [l[3] * l[0], l[3] * l[1], l[3] * l[2], l[3] * l[3]]])
#     return g